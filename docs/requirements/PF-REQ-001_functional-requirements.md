# 要件定義書（機能要件） — PlanForge LG（事業計画ドリルダウン生成器）

- 文書番号: PF-REQ-001
- 版数: v0.1
- 作成日: 2025-10-03
- 作成者: （未記入）
- 対象リリース: MVP

---

## 1. 背景・目的

自治体職員が、外資系コンサル流の体系に沿って、最小入力で根拠付きの事業計画草案を作成できるようにする。Why 起点で思考を構造化し、フレームワーク横断の整合を自動で担保する。

**目的**

- 初稿作成の所要時間を短縮し、説明責任を満たす前提と根拠を明示化する。
- 新米担当でも「漏れなく重複なく」を保った企画書を作れる状態にする。

---

## 2. スコープ（MVP）

### 2.1 対象

- Why ウィザード（最小入力）
- ロジックツリー自動生成・検査（MECE・矛盾・飛躍）
- フレームワーク統合（PEST/3C/SWOT/5F の最小入力 →1 ページ要旨）
- 市場規模試算（TAM/SAM/SOM）と簡易感度分析（Low/Med/High）
- 章立て済み事業計画の自動生成（Markdown/Word）
- 図表生成（ロジックツリー等の SVG/PNG）
- 前提・根拠メタデータ（assumption, confidence, evidence（複数可、要出典は空配列））付与
- 監査ログ（入力・出力・AI 補完の追跡）

### 2.2 非対象（MVP で扱わない）

- 詳細な財務連携（歳入歳出 CSV 自動整合）
- KPI ツリー自動生成の高度化（因果推定含む）
- 決裁スライド自動作成（PPTX）は範囲外
- 外部 SaaS 連携（チケット、BI、通知）は範囲外

---

## 3. ステークホルダー

- 企画担当（一次入力者・作成責任）
- 分析担当（検証・補正）
- 管理職/決裁者（レビュー主体）
- 情報政策/監査（監査ログ・PII 管理）

---

## 4. 主要ユーザー像

- 自治体の政策推進・企画部門の職員
- コンサル経験が浅い、または兼務で時間がない
- 必要スキル: フォーム入力と既存資料のアップロード程度

---

## 5. 想定ユースケース（要約）

1. 遊休公共施設の活用計画の草案作成
2. デマンド型交通の社会実験計画の初稿
3. 子育て支援施策の見直しに伴う再設計の骨子作り

---

## 6. 機能要件一覧（MVP）

優先度: M=Must / S=Should / C=Could / W=Won’t

| ID    | 機能               | 要件概要                                                                                                     | 優先 |
| ----- | ------------------ | ------------------------------------------------------------------------------------------------------------ | ---- |
| F-001 | プロジェクト作成   | タイトル/地域コード/カテゴリを登録。草案の入れ物を作る。                                                     | M    |
| F-002 | Why ウィザード     | 背景/将来像/成功条件/制約/関係者を 200 字上限で入力。未入力は AI 補完（仮説タグ付与）。                      | M    |
| F-003 | 追撃質問生成       | 入力の粒度不足を検知し、最大 5 問の追加質問を提示。回答は構造化格納。                                        | M    |
| F-004 | ロジックツリー生成 | Why から第 1 階層 3〜5 本と子階層を自動提案。根拠と不足データを付与。                                        | M    |
| F-005 | ロジック検査       | MECE/重複/飛躍/矛盾を検出し、修正パッチ案を提示。                                                            | M    |
| F-006 | フレームワーク入力 | PEST/3C/SWOT/5F の最小入力フォーム。100〜200 字。                                                            | M    |
| F-007 | フレームワーク統合 | 用語正規化と 1 ページ要旨（Markdown）を自動生成。矛盾ログを出力。                                            | M    |
| F-008 | 市場規模試算       | TAM/SAM/SOM 計算と Low/Med/High 感度表を作成。前提にリンク。                                                 | M    |
| F-009 | 図表生成           | ロジックツリーを Mermaid→SVG/PNG で出力。                                                                    | S    |
| F-010 | 事業計画出力       | 章立てテンプレに沿って Markdown/Word を出力。未確定は明示。                                                  | M    |
| F-011 | 前提・根拠管理     | すべての主張/数値に assumption/confidence/evidence（複数可、要出典は空配列）を紐付け。エクスポート時に検証。 | M    |
| F-012 | 監査ログ           | API 入出力の要約、モデル・プロンプトのメタ情報を保存。                                                       | M    |
| F-013 | プロジェクト共有   | 庁内ユーザー招待（メールアドレス指定）と閲覧/編集の権限付与（最小限の RBAC）。庁外共有・匿名アクセスは不可。 | S    |

---

## 7. 画面一覧（MVP）

- G-01: プロジェクト一覧
- G-02: プロジェクト概要（メタ情報・進捗）
- G-03: Why ウィザード
- G-04: 追撃質問キュー
- G-05: ロジックツリー編集（検査結果・パッチ適用）
- G-06: フレームワーク入力（PEST/3C/SWOT/5F）
- G-07: 市場規模試算
- G-08: 出力プレビュー（章立て・脚注・未確定タグ）
- G-09: 監査ログビュー

---

## 8. 入出力データ（概要）

- 入力: フォーム（短文）、既存資料ファイル（PDF/Word/Excel/CSV）※MVP は任意
- 出力: Markdown、Word（docx）、図（SVG/PNG）、監査ログ（JSON）

---

## 9. 成功指標（MVP 検収目安）

- 初稿作成リードタイム: 従来比 80％短縮
- 前提・根拠の付与率: 95％以上（章ブロック単位）
- 矛盾検出の最低発見率: 1 件/案件以上
- 出力の体裁不整合（見出し・脚注・図番号）ゼロ

---

## 10. 前提条件

- LLM 推論はサーバ側で実行し、入力・出力の監査を記録
- 用語正規化の辞書は初期セット（自治体語/一般語/コンサル語）を提供
- データソース台帳は別文書で管理（更新頻度・取得方法）

---

## 11. 制約条件

- 個人情報はフィールド単位マスキングが可能であること
- ネットワーク分離環境でもエクスポートが動作（完全オンライン依存にしない）
- 断定表現は禁止。AI 補完は必ず confidence を付与

---

## 12. 非機能（抜粋・詳細は別紙）

- 可用性: 営業時間帯 99.5％（MVP）
- 性能: 出力プレビュー生成 ≤ 8 秒（p95）
- セキュリティ: ログイン必須、プロジェクト単位 RBAC、監査証跡改ざん防止
- 監査: AI 入出力の要約・モデル情報・プロンプト ID を保存

---

## 13. リスクと対応（要約）

- 入力データ不足 → 追撃質問と「未確定」注記を標準化
- 幻覚（ハルシネーション） → 出典必須・断定禁止・未充足はフラグ
- 過剰分析 → 入力文字数上限と最小セットで強制

---

## 14. 受け入れ基準（高レベル）

- [ ] G-03→G-05→G-06→G-07→G-08→ 出力 までダミー案件で 30 分以内に通過
- [ ] 章立て・脚注・図番号が整合し、ビルドエラーがない
- [ ] すべての段落に assumption/confidence/evidence（複数可）が紐付け（要出典状態はエクスポート時にブロック）
- [ ] 矛盾検出とパッチ適用が 1 件以上成立
- [ ] 監査ログが全操作で記録され閲覧可能

---

## 15. 用語定義（抜粋）

- **Assumption**: 主張・数値の前提。confidence 必須、evidence（複数可）は作業中は省略可、エクスポート時に必須
- **Evidence**: 出典（URL/書誌/添付）。1 つの Assumption に複数紐付け可能
- **MECE**: 漏れなく重複なく。重複語は辞書で正規化
- **TAM/SAM/SOM**: 市場規模の 3 層。SOM は到達 × 転換 × 利用回数で算定

---

## 16. 変更履歴

- v0.1（2025-10-03）初稿
